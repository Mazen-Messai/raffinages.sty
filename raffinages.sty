% raffinages.sty - Package LaTeX pour raffinages
% Auteur : Mazen Messai
% Date : [à compléter]
% Description : Package pour la rédaction de raffinages structurés

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{raffinages}[2025/05/06 v1.0 Package pour les raffinages]
\RequirePackage{xparse}
\RequirePackage[dvipsnames]{xcolor}
\RequirePackage{etoolbox}
\RequirePackage{tabularx}
\RequirePackage{lineno}

% --- Commentaires ---
\newcommand{\commentaire}[1]{%
  \textcolor{blue}{-{}- \texttt{#1}}\par
}

% --- Raffinage principal ---
\NewDocumentEnvironment{raffinage}{mm}
{
  \begin{linenumbers}
  \par\noindent\texttt{R#1 : #2}\par
  \begingroup\leftskip=1em 
}
{
    \leftskip=0em\noindent\par
    \endgroup
    \end{linenumbers}
    \par\rule{0pt}{0pt}\par

}

% --- Étapes (action + [flux]) ---
\NewDocumentCommand{\step}{m o}{%
  \noindent
  \begin{minipage}{\dimexpr\linewidth - \leftskip\relax}
    \begin{tabularx}{\linewidth}{@{\hskip\leftskip}X r}
      \texttt{#1} & \IfValueT{#2}{\texttt{#2}}%
    \end{tabularx}%
  \end{minipage}%
  \par
}

% --- Environnement à indentation automatique ---
\newenvironment{ifstructure}[1]
{
    \par\noindent\texttt{Si #1 alors :}\par
    \begingroup\leftskip=2em
}
{
    \leftskip=1em\noindent\texttt{Fin Si}\par
    \endgroup
}

\newenvironment{whilestructure}[1]
{
  \par\noindent\texttt{\textcolor{Rhodamine}{Tantque} \textcolor{LimeGreen}{#1} \textcolor{Rhodamine}{faire} :}\par
  \begingroup\leftskip=2em
}
{
  \leftskip=1em\noindent\texttt{\textcolor{Rhodamine}{Fin Tantque}}\par
  \endgroup
}

\newenvironment{forstructure}[1]
{
  \par\noindent\texttt{Pour #1 faire :}\par
  \begingroup\leftskip=2em
}
{
  \leftskip=1em\noindent\texttt{Fin Pour}\par
  \endgroup
}


